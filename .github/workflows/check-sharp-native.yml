name: CI - check native modules (sharp)

on:
  pull_request:
  push:

jobs:
  sharp-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install backend deps
        working-directory: matrix-scaffold/backend
        run: |
          npm ci
      - name: Quick sharp import test
        working-directory: matrix-scaffold/backend
        run: |
          node -e "try{ require('sharp'); console.log('sharp: OK') } catch(e) { console.error('sharp import failed', e && e.message); process.exit(2) }"
      - name: Install puppeteer deps check
        run: echo "Puppeteer binaries will be installed during CI runs; ensure chromium is available in runner"
